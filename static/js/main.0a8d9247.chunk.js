(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{44:function(e,a,t){e.exports=t(84)},82:function(e,a,t){},83:function(e,a,t){},84:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),c=t(36),l=t(93),o=t(94),i=t(39),s=t(92),m=t(95),u=t(24),d=t(37),f=t.n(d),b=u.b.div({enter:{opacity:1,y:0,staggerChildren:50,beforeChildren:!0,delay:300},exit:{opacity:0,y:90,staggerChildren:20,staggerDirection:-1}}),p=t(6),h=t(28),v=t(89),k=t(90),g=t(38),E=t(87),N=t(91),y=t(88),w=function(e){return window.location.href.includes(e)?"active":""};function j(e){var a=e.location,t=e.history,n=e.initQuery,c=r.a.useRef(null),l=a.pathname.split("/"),o=Object(p.a)(l,3),i=(o[0],o[1]),s=o[2],m="books"==i?s||n:"",u=r.a.useState(m),d=Object(p.a)(u,2),f=d[0],b=d[1];return r.a.useEffect(function(){b(m)},[a.pathname]),r.a.useEffect(function(){var e=Object(k.a)(c.current,"input").pipe(Object(g.a)(function(e){return e.target.value}),Object(E.a)(Boolean),Object(N.a)(1e3),Object(y.a)()).subscribe(function(e){t.push("/books/".concat(e))});return function(){e.unsubscribe()}},[]),r.a.createElement("header",null,r.a.createElement("nav",{className:"row justify-content-center navbar navbar-expand-lg navbar-dark bg-dark"},r.a.createElement(h.a,{className:"navbar-brand text-light text-center col-lg-3 col-md-5 col-sm-12",to:"/"},r.a.createElement("img",{className:"app-logo",src:"/images/books.png",alt:"books App"}),"The Books Bank"),r.a.createElement("div",{className:"col-lg-5 col-md-6 col-sm-12"},r.a.createElement("input",{className:"form-control form-control-lg w-100",type:"search",placeholder:"Find your favorite books here ...","aria-label":"Search",ref:c,value:f,onChange:function(e){return b(e.target.value)}})),r.a.createElement("ul",{className:"navbar-nav col-lg-4 col-md-12 flex-center"},r.a.createElement("li",{className:"nav-item ".concat(w("/books"))},r.a.createElement(v.a,{className:"nav-link",to:"/books/".concat(n)},"Home")),r.a.createElement("li",{className:"nav-item ".concat(w("/favorites"))},r.a.createElement(v.a,{className:"nav-link",to:"/favorites"},"Favorites")),r.a.createElement("li",{className:"nav-item ".concat(w("/advanced-search"))},r.a.createElement(v.a,{className:"nav-link",to:"/advanced-search"},"Advanced Search")))))}var x=t(10),I=t(12),F=t(40),O=t(41),L=function(){function e(){Object(F.a)(this,e)}return Object(O.a)(e,null,[{key:"get",value:function(e){try{return JSON.parse(localStorage.getItem(e))}catch(a){return localStorage.getItem(e)}}},{key:"set",value:function(e,a){"object"===typeof a?localStorage.setItem(e,JSON.stringify(a)):localStorage.setItem(e,a)}},{key:"remove",value:function(e){localStorage.removeItem(e)}}]),e}(),S=t(17),C=t.n(S),q=t(23),T=t(29),_=t(42),D=t.n(_);function H(e){return z.apply(this,arguments)}function z(){return(z=Object(T.a)(C.a.mark(function e(a){var t,n,r,c,l,o,i;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=Object(p.a)(a,3),n=t[0],r=t[1],c=t[2],l=void 0===c?null:c,e.prev=1,e.next=4,D.a[n](r,l);case 4:if(o=e.sent,!(i=o.data).error){e.next=8;break}return e.abrupt("return",i.error);case 8:if(i&&i.totalItems){e.next=10;break}return e.abrupt("return","Not found!");case 10:return e.abrupt("return",i);case 13:return e.prev=13,e.t0=e.catch(1),e.abrupt("return",e.t0.message);case 16:case"end":return e.stop()}},e,null,[[1,13]])}))).apply(this,arguments)}function P(e,a,t,n,r,c){return B.apply(this,arguments)}function B(){return(B=Object(T.a)(C.a.mark(function e(a,t,n,r,c,l){var o;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(c({loading:!0,error:"",data:[],isFetching:!0}),!((o=L.get("raw_".concat(t,"_").concat(n)))&&Date.now()-o.timestamp<r)){e.next=6;break}c({loading:!1,error:"",data:L.get("".concat(t,"_").concat(n))||l(o,"".concat(t,"_").concat(n)),isFetching:!1}),e.next=10;break;case 6:return e.next=8,H(a);case 8:"string"===typeof(o=e.sent)?c({loading:!1,error:o,data:[],isFetching:!1}):(o.timestamp=Date.now(),L.set("raw_".concat(t,"_").concat(n),JSON.stringify(o)),Q("".concat(t,"_").concat(n)),delete o.timestamp,c({loading:!1,error:"",data:l(o,"".concat(t,"_").concat(n)),isFetching:!1}));case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}var R=function(e,a){return e&&e.length>a?e.slice(0,a-3)+"...":e},A={year:31536e6,month:2592e6,week:6048e5,day:864e5,hour:36e5,minute:6e4,second:1e3};function J(e){var a=e.key,t=e.req,r=e.timeout,c=void 0===r?A.month:r,l=e.deps,o=void 0===l?[]:l,i=e.map,s=void 0===i?function(e){return e}:i,m=Object(n.useState)({loading:!0,error:"",data:[],isFetching:!1}),u=Object(p.a)(m,2),d=u[0],f=u[1];return Object(n.useEffect)(function(){P(t,a,1,c,f,s)},o),d}var U=function(e,a){return e.items.map(function(e){return function(a){return{bookId:a.id,title:a.volumeInfo.title,subtitle:a.volumeInfo.subtitle,authors:a.volumeInfo.authors?a.volumeInfo.authors.join(", "):"",publisher:a.volumeInfo.publisher,publishedDate:a.volumeInfo.publishedDate,description:a.volumeInfo.description,pageCount:a.volumeInfo.pageCount,rating:a.volumeInfo.averageRating,language:a.volumeInfo.language,thumb:a.volumeInfo.imageLinks?a.volumeInfo.imageLinks.smallThumbnail:"",thumbnail:a.volumeInfo.imageLinks?a.volumeInfo.imageLinks.thumbnail:"",previewUrl:a.volumeInfo.previewLink,infoUrl:a.volumeInfo.infoLink,country:a.accessInfo.country,pdfLink:a.accessInfo.pdf.downloadLink,webReaderLink:a.accessInfo.webReaderLink,buyLink:a.saleInfo.buyLink,selfLink:a.selfLink,isFavorite:!1,query:e}}}(a))},Q=function(e){var a=L.get("lookup");a?a.includes(e)||L.set("lookup",[].concat(Object(I.a)(a),[e])):L.set("lookup",[e])},M=function(e){var a=e.query,t=void 0===a?"":a,n=e.search,r=void 0===n?"":n,c=e.start,l=e.pageSize;return t?["get","https://www.googleapis.com/books/v1/volumes?printType=books&maxResults=".concat(l,"&startIndex=").concat(c,"&q=").concat(t)]:["get","https://www.googleapis.com/books/v1/volumes?maxResults=".concat(l,"&startIndex=").concat(c,"&").concat(r)]},W=0,Y=2;function G(){return r.a.createElement("main",{className:"text-center"},r.a.createElement("div",{className:"spinner-border",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading...")))}var K={};function V(e){var a=e.books,t=e.favoriteHandler;return a.map(function(e){return K={pathname:"/book/".concat(e.bookId),state:e},r.a.createElement("div",{key:e.bookId,className:"col-lg-3 col-md-6 col-sm-12 mb-3"},r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-header flex-between bg-primary text-light"},r.a.createElement("h5",{className:"card-title"},r.a.createElement(h.a,{className:"text-light",to:K},R(e.title,15))),t?r.a.createElement("i",{id:e.bookId,query:e.query,className:"".concat(e.isFavorite?"fas":"far"," fa-star"),onClick:t}):null),r.a.createElement(h.a,{to:K},r.a.createElement("img",{src:e.thumb,className:"card-img-top",alt:e.title})),r.a.createElement("div",{className:"card-footer text-center"},r.a.createElement("small",{className:"text-muted d-block"},e.publisher),r.a.createElement("small",{className:"text-muted d-block"},e.country," | ",e.publishedDate," | ",e.language))))})}var X=12,Z=[];function $(e){var a=e.match.params.query,t=J({req:M({query:a,start:0,pageSize:X}),key:a,map:U}),c=t.loading,l=t.error,o=t.data,i=function(e){var a=e.key,t=e.pageSize,r=e.timeout,c=void 0===r?A.month:r,l=e.map,o=void 0===l?function(e){return e}:l,i=Object(n.useState)({loading:!0,error:"",data:[],isFetching:!1}),s=Object(p.a)(i,2),m=s[0],u=s[1],d=function(){window.innerHeight+window.scrollY>=document.body.offsetHeight&&u({loading:!0,error:"",data:[],isFetching:!0})};return Object(n.useEffect)(function(){return window.addEventListener("scroll",d),function(){return window.removeEventListener("scroll",d)}},[]),Object(n.useEffect)(function(){m.isFetching&&P(M(a,W+=t,t),a,Y++,c,u,o)},[m.isFetching]),m}({key:a,pageSize:X,map:U}),s=i.isFetching,m=i.data,u=r.a.useState([]),d=Object(p.a)(u,2),f=d[0],b=d[1],h=r.a.useState(0),v=Object(p.a)(h,2),k=v[0],g=v[1];r.a.useEffect(function(){o.length&&(b(o),g(k+1))},[o.length]),r.a.useEffect(function(){m.length&&(b([].concat(Object(I.a)(f),Object(I.a)(m))),g(k+1))},[m.length]),r.a.useEffect(function(){f.length&&L.get("lookup").forEach(function(e){(Z=f.filter(function(a){return a.query===e})).length&&L.set(e,Z)})},[f]);return c?r.a.createElement(G,null):r.a.createElement("main",{className:"row justify-content-between"},l?r.a.createElement("div",{className:"alert alert-danger w-100 text-center",role:"alert"},l):r.a.createElement(V,{books:f,favoriteHandler:function(e){var a=e.target;b(f.map(function(e){return e.bookId===a.id?Object(x.a)({},e,{isFavorite:!e.isFavorite}):e}))}}),s?r.a.createElement(G,null):null)}var ee=[],ae=function(e,a){return function(){a(Object(x.a)({},e,{isFavorite:!e.isFavorite})),ee=(ee=L.get(e.query)).map(function(a){return a.bookId===e.bookId?Object(x.a)({},e,{isFavorite:!e.isFavorite}):a}),L.set(e.query,ee)}};function te(e){var a=e.location,t=r.a.useState(a.state),n=Object(p.a)(t,2),c=n[0],l=n[1];return c?r.a.createElement("main",null,r.a.createElement("div",{className:"card mb-3"},r.a.createElement("div",{className:"card-header flex-between bg-primary text-light"},r.a.createElement("h3",{className:"card-title"},c.title),r.a.createElement("i",{id:c.bookId,className:"".concat(c.isFavorite?"fas":"far"," fa-star"),onClick:ae(c,l)})),r.a.createElement("div",{className:"card-body flex-around-top"},r.a.createElement("img",{className:"flex-b-30",src:c.thumb,alt:c.title}),r.a.createElement("div",{className:"flex-b-60"},r.a.createElement("h4",{className:"card-subtitle mb-2 text-muted"},c.subtitle),r.a.createElement("p",{className:"card-text"},"Author(s): ",c.authors),r.a.createElement("p",{className:"card-text"},c.description),r.a.createElement("p",{className:"card-text"},"Publisher: ",c.publisher),r.a.createElement("p",{className:"card-text"},"Published Date: ",c.publishedDate),r.a.createElement("p",{className:"card-text"},"Country: ",c.country),r.a.createElement("p",{className:"card-text"},"Language: ",c.language),r.a.createElement("p",{className:"card-text"},"Page Count: ",c.pageCount))),r.a.createElement("div",{className:"card-footer text-center"},r.a.createElement("a",{target:"_blank",href:c.infoUrl,className:"card-link"},"More Info Link"),r.a.createElement("a",{target:"_blank",href:c.previewUrl,className:"card-link"},"Preview Link"),r.a.createElement("a",{target:"_blank",href:c.webReaderLink,className:"card-link"},"Web Reader Link"),c.pdfLink&&r.a.createElement("a",{target:"_blank",href:c.pdfLink,className:"card-link"},"PDF Link"),c.buyLink&&r.a.createElement("a",{target:"_blank",href:c.buyLink,className:"card-link"},"Buy Link")))):r.a.createElement("main",null,r.a.createElement("div",{className:"alert alert-warning w-100 text-center",role:"alert"},"Book Not Found ..."))}var ne=[],re={};function ce(e){e.match;var a=r.a.useState([]),t=Object(p.a)(a,2),n=t[0],c=t[1];r.a.useEffect(function(){L.get("lookup").forEach(function(e){c([].concat(Object(I.a)(n),Object(I.a)(L.get(e).filter(function(e){return e.isFavorite}))))})},[]);return n?r.a.createElement("main",{className:"row justify-content-center"},r.a.createElement(V,{books:n,favoriteHandler:function(e){var a=e.target;re=n.find(function(e){return e.bookId===a.id}),c(n.filter(function(e){return e.bookId!==a.id})),ne=(ne=L.get(re.query)).map(function(e){return e.bookId===re.bookId?Object(x.a)({},re,{isFavorite:!1}):e}),L.set(re.query,ne)}})):r.a.createElement("main",null,r.a.createElement("div",{className:"alert alert-warning w-100 text-center",role:"alert"},"Favorite Books Not Found ..."))}var le="";function oe(e){var a=e.history,t=function(e){var a=Object(n.useState)(e),t=Object(p.a)(a,2),r=t[0],c=t[1];return{state:r,changeHandler:function(e){var a=e.target;c(Object(x.a)({},r,Object(q.a)({},a.name,a.value)))},submitHandler:function(e){return function(a){a.preventDefault(),e(r)}}}}({title:"",author:"",publisher:"",subject:"",isbn:"",downloadFormat:"",filter:"",printType:""}),c=t.state,l=t.changeHandler,o=t.submitHandler;return r.a.createElement("main",null,r.a.createElement("h3",null,"Advanced Search"),r.a.createElement("hr",null),r.a.createElement("form",{className:"row",onSubmit:o(function(e){var t=e.title,n=e.author,r=e.publisher,c=e.subject,l=e.isbn,o=e.downloadFormat,i=e.filter,s=e.printType;le="",t&&(le+="q=intitle:".concat(e.title)),n&&(le+=le?"+inauthor:".concat(n):"q=inauthor:".concat(n)),r&&(le+=le?"+inpublisher:".concat(r):"q=inpublisher:".concat(r)),c&&(le+=le?"+subject:".concat(c):"q=subject:".concat(c)),l&&(le+=le?"+isbn:".concat(l):"q=isbn:".concat(l)),o&&(le+="&download=".concat(o)),i&&(le+="&filter=".concat(i)),s&&(le+="&printType=".concat(s)),a.push("/search-result/".concat(le))})},r.a.createElement("div",{className:"col-lg-6 col-md-12"},r.a.createElement("input",{type:"text",className:"form-control mb-2",placeholder:"Title",name:"title",value:c.title,onChange:l}),r.a.createElement("input",{type:"text",className:"form-control mb-2",placeholder:"Author",name:"author",value:c.author,onChange:l}),r.a.createElement("input",{type:"text",className:"form-control mb-2",placeholder:"Publisher",name:"publisher",value:c.publisher,onChange:l}),r.a.createElement("input",{type:"text",className:"form-control mb-2",placeholder:"Subject",name:"subject",value:c.subject,onChange:l}),r.a.createElement("input",{type:"text",className:"form-control mb-2",placeholder:"ISBN",name:"isbn",value:c.isbn,onChange:l})),r.a.createElement("div",{className:"col-lg-6 col-md-12"},r.a.createElement("div",{className:"mb-2"},r.a.createElement("div",null,"Download Format:"),r.a.createElement("div",{className:"form-check form-check-inline"},r.a.createElement("input",{className:"form-check-input",id:"epub",type:"checkbox",name:"downloadFormat",value:"epub",checked:"epub"===c.downloadFormat,onChange:l}),r.a.createElement("label",{className:"form-check-label",htmlFor:"epub"},"epub"))),r.a.createElement("div",{className:"mb-2"},r.a.createElement("div",null,"Payment And Preview Ability:"),r.a.createElement("div",{className:"form-check form-check-inline"},r.a.createElement("input",{className:"form-check-input",id:"full-preview",type:"radio",name:"filter",value:"full",checked:"full"===c.filter,onChange:l}),r.a.createElement("label",{className:"form-check-label",htmlFor:"full-preview"},"full-preview")),r.a.createElement("div",{className:"form-check form-check-inline"},r.a.createElement("input",{className:"form-check-input",id:"partial-preview",type:"radio",name:"filter",value:"partial",checked:"partial"===c.filter,onChange:l}),r.a.createElement("label",{className:"form-check-label",htmlFor:"partial-preview"},"partial-preview")),r.a.createElement("div",{className:"form-check form-check-inline"},r.a.createElement("input",{className:"form-check-input",id:"free-ebooks",type:"radio",name:"filter",value:"free-ebooks",checked:"free-ebooks"===c.filter,onChange:l}),r.a.createElement("label",{className:"form-check-label",htmlFor:"free-ebooks"},"free-ebooks")),r.a.createElement("div",{className:"form-check form-check-inline"},r.a.createElement("input",{className:"form-check-input",id:"paid-ebooks",type:"radio",name:"filter",value:"paid-ebooks",checked:"paid-ebooks"===c.filter,onChange:l}),r.a.createElement("label",{className:"form-check-label",htmlFor:"paid-ebooks"},"paid-ebooks")),r.a.createElement("div",{className:"form-check form-check-inline"},r.a.createElement("input",{className:"form-check-input",id:"ebooks",type:"radio",name:"filter",value:"ebooks",checked:"ebooks"===c.filter,onChange:l}),r.a.createElement("label",{className:"form-check-label",htmlFor:"ebooks"},"ebooks (free+paid+full-preview)"))),r.a.createElement("div",{className:"mb-2"},r.a.createElement("div",null,"Print Type:"),r.a.createElement("div",{className:"form-check form-check-inline"},r.a.createElement("input",{className:"form-check-input",id:"all",type:"radio",name:"printType",value:"all",checked:"all"===c.printType,onChange:l}),r.a.createElement("label",{className:"form-check-label",htmlFor:"all"},"all")),r.a.createElement("div",{className:"form-check form-check-inline"},r.a.createElement("input",{className:"form-check-input",id:"books",type:"radio",name:"printType",value:"books",checked:"books"===c.printType,onChange:l}),r.a.createElement("label",{className:"form-check-label",htmlFor:"books"},"books")),r.a.createElement("div",{className:"form-check form-check-inline"},r.a.createElement("input",{className:"form-check-input",id:"magazines",type:"radio",name:"printType",value:"magazines",checked:"magazines"===c.printType,onChange:l}),r.a.createElement("label",{className:"form-check-label",htmlFor:"magazines"},"magazines")))),r.a.createElement("button",{className:"btn btn-primary btn-lg w-25 mx-auto"},"Search")))}function ie(e){var a=e.match.params.search,t=J({req:M({search:a,start:0,pageSize:40}),key:a,map:U}),n=t.loading,c=t.error,l=t.data;return n?r.a.createElement(G,null):r.a.createElement("main",{className:"row justify-content-center"},c?r.a.createElement("div",{className:"alert alert-danger w-100 text-center",role:"alert"},c):r.a.createElement(V,{books:l,favoriteHandler:null}))}t(82);var se="birds";var me=Object(m.a)(function(e){var a=e.location,t=e.history;return r.a.createElement(r.a.Fragment,null,r.a.createElement(j,{location:a,history:t,initQuery:se}),r.a.createElement("div",{className:"container"},r.a.createElement(u.a,null,r.a.createElement(b,{key:f.a.generate()},r.a.createElement(o.a,{location:a},r.a.createElement(i.a,{path:"/books/:query",component:$}),r.a.createElement(i.a,{path:"/book/:id",component:te}),r.a.createElement(i.a,{path:"/favorites",component:ce}),r.a.createElement(i.a,{path:"/advanced-search",component:oe}),r.a.createElement(i.a,{path:"/search-result/:search",component:ie}),r.a.createElement(s.a,{to:"/books/".concat(se)}))))))});t(83);Object(c.render)(r.a.createElement(l.a,null,r.a.createElement(me,null)),document.getElementById("root"))}},[[44,1,2]]]);
//# sourceMappingURL=main.0a8d9247.chunk.js.map